<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>副詞クイズ（穴埋め・テキスト入力）</title>
  <style>
    body {
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      padding:1rem;
      line-height:1.6;
    }
    #stats {
      margin-bottom:0.5rem;
      font-weight:bold;
      min-height:1.2em;
    }
    .card {
      border:1px solid #ccc;
      border-radius:10px;
      padding:1rem;
      margin-bottom:1rem;
    }
    .masked { font-weight:600; font-size:1.3rem; margin-bottom:.5rem; }
    .input-row {
      display:flex;
      gap:.5rem;
      margin-top:.5rem;
      margin-bottom:.5rem;
    }
    .input-row input[type="text"] {
      flex:1;
      padding:.5rem;
      font-size:1.05rem;
      border-radius:6px;
      border:1px solid #888;
    }
    .btn {
      padding:.6rem 1rem;
      border-radius:8px;
      border:1px solid #555;
      background:#f5f5f5;
      cursor:pointer;
      font-size:1rem;
    }
    .btn:disabled {
      opacity:0.5;
      cursor:default;
    }
    .hint-row {
      display:flex;
      gap:.5rem;
      margin-bottom:.5rem;
      flex-wrap:wrap;
    }
    .hints {
      font-size:.95rem;
      color:#444;
      min-height:1.2em;
    }
    .result {
      margin-top:.4rem;
      font-weight:bold;
    }
    .result.ok {
      color:#1a7f1a;
    }
    .result.ng {
      color:#c0392b;
    }
    .answer {
      margin-top:.3rem;
      font-size:.95rem;
      color:#333;
      display:none;
    }
    #nav {
      margin-top:.8rem;
      display:flex;
      gap:.5rem;
    }
    #nav button {
      flex:1;
      padding:.5rem;
      border-radius:8px;
      border:1px solid #555;
      background:#f0f0f0;
      cursor:pointer;
    }
    #nav button:disabled {
      opacity:0.5;
      cursor:default;
    }
    
    .target-word {
      font-weight:700;
      font-size:1.1rem;
    }
    .answer-meta {
      font-size:.9rem;
      color:#555;
      margin-bottom:.3rem;
    }

    @media (max-width: 600px) {
      .masked { font-size:1.15rem; }
      .input-row input[type="text"] { font-size:1.1rem; }
      .btn { font-size:1.05rem; }
    }
  </style>
</head>
<body>
  <h1>副詞クイズ（穴埋め）</h1>
  <div id="stats"></div>
  <div id="app"></div>
  <div id="nav">
    <button id="nextBtn">次の問題へ</button>
  </div>

  <script>
    const data = [
  {
    "word": "とっぷり",
    "sentence": "陽がとっぷり暮れる。",
    "masked": "陽が⬜︎⬜︎⬜︎⬜︎暮れる。"
  },
  {
    "word": "すごすご",
    "sentence": "先方ににべもなく断られ、すごすごと退散した。",
    "masked": "先方ににべもなく断られ、⬜︎⬜︎⬜︎⬜︎と退散した。"
  },
  {
    "word": "あながち",
    "sentence": "彼の言うことはあながち間違えではない。",
    "masked": "彼の言うことは⬜︎⬜︎⬜︎⬜︎間違えではない。"
  },
  {
    "word": "おざなり",
    "sentence": "宿題をおざなりに済ませていたら、先生に注意された。",
    "masked": "宿題を⬜︎⬜︎⬜︎⬜︎に済ませていたら、先生に注意された。"
  },
  {
    "word": "あわや",
    "sentence": "あわや大惨事が起こるところだった。",
    "masked": "⬜︎⬜︎⬜︎大惨事が起こるところだった。"
  },
  {
    "word": "いささか",
    "sentence": "今回の企画は、いささか実現性に欠けるのではないか。",
    "masked": "今回の企画は、⬜︎⬜︎⬜︎⬜︎実現性に欠けるのではないか。"
  },
  {
    "word": "いくえにも",
    "sentence": "山々が雲の向こうにいくえにも連なっている。",
    "masked": "山々が雲の向こうに⬜︎⬜︎⬜︎⬜︎⬜︎連なっている。"
  },
  {
    "word": "いざ知らず",
    "sentence": "昔はいざ知らず、現在こんな話を信じる人はいないだろう。",
    "masked": "昔は⬜︎⬜︎⬜︎⬜︎⬜︎、現在こんな話を信じる人はいないだろう。"
  },
  {
    "word": "おおむね",
    "sentence": "作業はおおむね完了していますので、予定通り納品いたします。",
    "masked": "作業は⬜︎⬜︎⬜︎⬜︎完了していますので、予定通り納品いたします。"
  },
  {
    "word": "おもむろに",
    "sentence": "敵に囲まれたが、彼はおもむろに立ち上がった。",
    "masked": "敵に囲まれたが、彼は⬜︎⬜︎⬜︎⬜︎⬜︎立ち上がった。"
  },
  {
    "word": "おりから",
    "sentence": "おりからの強風にあおられ火事が拡大した。",
    "masked": "⬜︎⬜︎⬜︎⬜︎の強風にあおられ火事が拡大した。"
  },
  {
    "word": "こよなく",
    "sentence": "彼女はアートをこよなく愛し、毎週末ギャラリー巡りをしている。",
    "masked": "彼女はアートを⬜︎⬜︎⬜︎⬜︎愛し、毎週末ギャラリー巡りをしている。"
  },
  {
    "word": "たまゆら",
    "sentence": "たまゆらの休息を心ゆくまで楽しむ。",
    "masked": "⬜︎⬜︎⬜︎⬜︎の休息を心ゆくまで楽しむ。"
  },
  {
    "word": "つつがなく",
    "sentence": "ご無沙汰しておりますが、皆様つつがなくお過ごしでしょうか。",
    "masked": "ご無沙汰しておりますが、皆様⬜︎⬜︎⬜︎⬜︎⬜︎お過ごしでしょうか。"
  },
  {
    "word": "つぶさに",
    "sentence": "事件の一部始終をつぶさに報告する。",
    "masked": "事件の一部始終を⬜︎⬜︎⬜︎⬜︎報告する。"
  },
  {
    "word": "なまじ",
    "sentence": "なまじ自信があったのが災いして、失敗してしまった。",
    "masked": "⬜︎⬜︎⬜︎自信があったのが災いして、失敗してしまった。"
  },
  {
    "word": "なおざりに",
    "sentence": "ユーザーからの問い合わせをなおざりにするなんて、もってのほかだ。",
    "masked": "ユーザーからの問い合わせを⬜︎⬜︎⬜︎⬜︎⬜︎するなんて、もってのほかだ。"
  },
  {
    "word": "にべもなく",
    "sentence": "頼み事をしたが、にべもなく断られた。",
    "masked": "頼み事をしたが、⬜︎⬜︎⬜︎⬜︎⬜︎断られた。"
  },
  {
    "word": "のべつまくなしに",
    "sentence": "窓口で1人の客がのべつまくなしに話し続けている。",
    "masked": "窓口で1人の客が⬜︎⬜︎⬜︎⬜︎⬜︎⬜︎⬜︎⬜︎話し続けている。"
  },
  {
    "word": "ひとえに",
    "sentence": "プロジェクトの成功は、ひとえに皆様方のご支援とご協力のおかげです。",
    "masked": "プロジェクトの成功は、⬜︎⬜︎⬜︎⬜︎皆様方のご支援とご協力のおかげです。"
  },
  {
    "word": "ひとしお",
    "sentence": "並々ならぬ勉強の末の合格は、喜びもひとしおだ。",
    "masked": "並々ならぬ勉強の末の合格は、喜びも⬜︎⬜︎⬜︎⬜︎だ。"
  },
  {
    "word": "やおら",
    "sentence": "ずっと沈黙を貫いていた彼が、やおら口を開き真実を語り始めた。",
    "masked": "ずっと沈黙を貫いていた彼が、⬜︎⬜︎⬜︎口を開き真実を語り始めた。"
  },
  {
    "word": "やにわに",
    "sentence": "会議中にやにわに停電が発生し、一同が騒然とした。",
    "masked": "会議中に⬜︎⬜︎⬜︎⬜︎停電が発生し、一同が騒然とした。"
  },
  {
    "word": "ゆめゆめ",
    "sentence": "勝って当然の試合だったので、負けるなんてゆめゆめ考えもしなかった。",
    "masked": "勝って当然の試合だったので、負けるなんて⬜︎⬜︎⬜︎⬜︎考えもしなかった。"
  },
  {
    "word": "せきらら",
    "sentence": "本心をせきららに打ち明けた。",
    "masked": "本心を⬜︎⬜︎⬜︎⬜︎に打ち明けた。"
  },
  {
    "word": "かんまん",
    "sentence": "クレームに対するかんまんな対応にいらだつ。",
    "masked": "クレームに対する⬜︎⬜︎⬜︎⬜︎な対応にいらだつ。"
  },
  {
    "word": "たおやか",
    "sentence": "風にそよぐたおやかな柳の枝を描く。",
    "masked": "風にそよぐ⬜︎⬜︎⬜︎⬜︎な柳の枝を描く。"
  },
  {
    "word": "ねんごろ",
    "sentence": "大切な客人に対しねんごろなもてなしを心がける。",
    "masked": "大切な客人に対し⬜︎⬜︎⬜︎⬜︎なもてなしを心がける。"
  },
  {
    "word": "かぶん",
    "sentence": "先方のかぶんな心づかいに感謝する。",
    "masked": "先方の⬜︎⬜︎⬜︎な心づかいに感謝する。"
  },
  {
    "word": "あこぎ",
    "sentence": "なりふりかまわずあこぎなやり方でお金をかせぐ。",
    "masked": "なりふりかまわず⬜︎⬜︎⬜︎なやり方でお金をかせぐ。"
  },
  {
    "word": "うららか",
    "sentence": "うららかな小鳥のさえずりに目を覚ました。",
    "masked": "⬜︎⬜︎⬜︎⬜︎な小鳥のさえずりに目を覚ました。"
  },
  {
    "word": "うかつ",
    "sentence": "私としたことがうかつにもすっかり忘れていた。",
    "masked": "私としたことが⬜︎⬜︎⬜︎にもすっかり忘れていた。"
  },
  {
    "word": "あしざま",
    "sentence": "けんか相手のことをあしざまに言う。",
    "masked": "けんか相手のことを⬜︎⬜︎⬜︎⬜︎に言う。"
  },
  {
    "word": "そぞろ",
    "sentence": "雨上がりはそぞろに外に出たくなる。",
    "masked": "雨上がりは⬜︎⬜︎⬜︎に外に出たくなる。"
  },
  {
    "word": "あながち",
    "sentence": "彼の言うことはあながち間違ってはいない。",
    "masked": "彼の言うことは⬜︎⬜︎⬜︎⬜︎間違ってはいない。"
  },
  {
    "word": "あいにく",
    "sentence": "父はあいにく外出しております。",
    "masked": "父は⬜︎⬜︎⬜︎⬜︎外出しております。"
  }
];

    // ランダム順に出題
    const order = data.map((_, i) => i);
    for (let i = order.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [order[i], order[j]] = [order[j], order[i]];
    }

    let pos = 0; // order上の位置
    let answeredCount = 0;
    let correctCount = 0;
    const answeredFlags = Array(data.length).fill(false);
    const correctFlags = Array(data.length).fill(false);

    function normalize(str) {
      return (str || "").trim();
    }

    function updateStats() {
      const el = document.getElementById("stats");
      if (answeredCount === 0) {
        el.textContent = "";
      } else {
        const rate = Math.round((correctCount / answeredCount) * 100);
        el.textContent = `現在の正解数：${correctCount} / ${answeredCount} 問（正答率 ${rate}%）`;
      }
    }

        function renderQuestion() {
      const app = document.getElementById("app");
      const idx = order[pos];
      const item = data[idx];
      const word = (item.word || "");
      const expectedLen = word.length;
      const placeholderBoxes = "⬜︎".repeat(expectedLen || 1);
      const firstChar = word.slice(0, 1);
      const lastChar = word.slice(-1);

      app.innerHTML = "";
      const card = document.createElement("div");
      card.className = "card";

      const q = document.createElement("div");
      q.className = "masked";
      q.textContent = item.masked; // ⬜︎で穴埋めされた文
      card.appendChild(q);

      // ヒント表示エリア
      const hintRow = document.createElement("div");
      hintRow.className = "hint-row";
      const hintFirstBtn = document.createElement("button");
      hintFirstBtn.className = "btn";
      hintFirstBtn.textContent = "先頭ヒント";
      const hintLastBtn = document.createElement("button");
      hintLastBtn.className = "btn";
      hintLastBtn.textContent = "末尾ヒント";
      hintRow.appendChild(hintFirstBtn);
      hintRow.appendChild(hintLastBtn);
      card.appendChild(hintRow);

      const hints = document.createElement("div");
      hints.className = "hints";
      hints.textContent = "";
      card.appendChild(hints);

      // 入力欄＋答えるボタン
      const inputRow = document.createElement("div");
      inputRow.className = "input-row";
      const input = document.createElement("input");
      input.type = "text";
      input.autocomplete = "off";
      input.placeholder = placeholderBoxes + `（${expectedLen}文字）`;
      const answerBtn = document.createElement("button");
      answerBtn.className = "btn";
      answerBtn.textContent = "答える";
      answerBtn.disabled = true;
      inputRow.appendChild(input);
      inputRow.appendChild(answerBtn);
      card.appendChild(inputRow);

      const meta = document.createElement("div");
      meta.className = "answer-meta";
      meta.textContent = `※ ${expectedLen}文字で入力してね。`;
      card.appendChild(meta);

      const result = document.createElement("div");
      result.className = "result";
      card.appendChild(result);

      const ans = document.createElement("div");
      ans.className = "answer";
      ans.textContent = "【答え】 " + item.sentence;
      card.appendChild(ans);

      let firstHintShown = false;
      let lastHintShown = false;

      function updateAnswerButton() {
        const val = normalize(input.value);
        const len = val.length;
        if (len === expectedLen && expectedLen > 0) {
          answerBtn.disabled = false;
        } else {
          answerBtn.disabled = true;
        }
      }
      input.addEventListener("input", updateAnswerButton);

      const blankChar = "⬜︎";

      hintFirstBtn.onclick = () => {
        if (firstHintShown) return;
        firstHintShown = true;
        const t = q.textContent;
        const i = t.indexOf(blankChar);
        if (i >= 0) {
          q.textContent = t.slice(0, i) + firstChar + t.slice(i + blankChar.length);
        }
      };

      hintLastBtn.onclick = () => {
        if (lastHintShown) return;
        lastHintShown = true;
        const t = q.textContent;
        const i = t.lastIndexOf(blankChar);
        if (i >= 0) {
          q.textContent = t.slice(0, i) + lastChar + t.slice(i + blankChar.length);
        }
      };

      function lockAndJudge() {
        if (answerBtn.disabled) return;
        if (card.dataset.done === "1") return;
        const userAns = normalize(input.value);
        const correct = normalize(word);
        card.dataset.done = "1";

        if (!userAns) {
          result.textContent = "入力が空だよ。もう一度考えてみよう。";
          result.classList.add("ng");
        } else if (userAns === correct) {
          result.textContent = "正解！";
          result.classList.add("ok");
          if (!answeredFlags[idx]) {
            answeredFlags[idx] = true;
            answeredCount += 1;
            correctFlags[idx] = true;
            correctCount += 1;
          } else if (!correctFlags[idx]) {
            correctFlags[idx] = true;
            correctCount += 1;
          }
        } else {
          result.textContent = `不正解… 正しくは『${correct}』だよ。`;
          result.classList.add("ng");
          if (!answeredFlags[idx]) {
            answeredFlags[idx] = true;
            answeredCount += 1;
          }
        }

        ans.style.display = "block";
        answerBtn.disabled = true;
        input.disabled = true;
        hintFirstBtn.disabled = true;
        hintLastBtn.disabled = true;

        updateStats();
        updateNavButtonState();
      }

      answerBtn.onclick = lockAndJudge;
      input.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          e.preventDefault();
          lockAndJudge();
        }
      });

      app.appendChild(card);
      updateNavButtonState();
    }

    function updateNavButtonState() {
      const nextBtn = document.getElementById("nextBtn");
      const idx = order[pos];
      const answered = answeredFlags[idx];
      if (!answered) {
        nextBtn.disabled = true;
      } else {
        nextBtn.disabled = (pos === order.length - 1);
        if (pos === order.length - 1) {
          nextBtn.textContent = "これでおしまい";
        } else {
          nextBtn.textContent = "次の問題へ";
        }
      }
    }

    document.getElementById("nextBtn").addEventListener("click", () => {
      if (pos < order.length - 1) {
        pos += 1;
        renderQuestion();
      }
    });

    renderQuestion();
    updateStats();
  </script>
</body>
</html>
